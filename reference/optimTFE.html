<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>optimTFE algorithm — optimTFE • optimTFE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="optimTFE algorithm — optimTFE"><meta name="description" content="Generate a suite of conservation footprint 'solutions' based on feature
suitability values and a list of targets for all features."><meta property="og:description" content="Generate a suite of conservation footprint 'solutions' based on feature
suitability values and a list of targets for all features."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">optimTFE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dleopold/optimTFE.git/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>optimTFE algorithm</h1>
      <small class="dont-index">Source: <a href="https://github.com/dleopold/optimTFE.git/blob/main/R/optimTFE.R" class="external-link"><code>R/optimTFE.R</code></a></small>
      <div class="d-none name"><code>optimTFE.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generate a suite of conservation footprint 'solutions' based on feature
suitability values and a list of targets for all features.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">optimTFE</span><span class="op">(</span></span>
<span>  targets <span class="op">=</span> <span class="fu">optimTFE</span><span class="fu">::</span><span class="va"><a href="example_targets.html">example_targets</a></span>,</span>
<span>  suitability <span class="op">=</span> <span class="fu">optimTFE</span><span class="fu">::</span><span class="va"><a href="example_suitability.html">example_suitability</a></span>,</span>
<span>  subregions <span class="op">=</span> <span class="fu">optimTFE</span><span class="fu">::</span><span class="va"><a href="example_subregions.html">example_subregions</a></span>,</span>
<span>  populations <span class="op">=</span> <span class="fu">optimTFE</span><span class="fu">::</span><span class="va"><a href="example_populations.html">example_populations</a></span>,</span>
<span>  incompatibility <span class="op">=</span> <span class="fu">optimTFE</span><span class="fu">::</span><span class="va"><a href="example_incompatibility.html">example_incompatibility</a></span>,</span>
<span>  spatial <span class="op">=</span> <span class="fu">optimTFE</span><span class="fu">::</span><span class="va"><a href="example_spatial.html">example_spatial</a></span>,</span>
<span>  min_spp_suit_score <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  rand_tolerance <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  max_spp_selected <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  single_pu_pop <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  batch_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_batch_size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  out_dir <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  run_id <span class="op">=</span> <span class="st">"optimTFE"</span>,</span>
<span>  output_csv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_df <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  force_overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  summary <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  spatial_projection <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-targets">targets<a class="anchor" aria-label="anchor" href="#arg-targets"></a></dt>
<dd><p>species targets file - path to a csv file or a pre-loaded data
frame or matrix. If loading from file, the first column should contain the
species names, otherwise species names should be included as row names. The
column direclty following the species names should contain the total
targets for each species. Additional columns should specify the (optional)
subregion targets, with values specifying the minimum targets required in
each subregion.</p></dd>


<dt id="arg-suitability">suitability<a class="anchor" aria-label="anchor" href="#arg-suitability"></a></dt>
<dd><p>species suitability matrix - path to a csv/tsv file or a
pre-loaded data frame or matrix. The first column must be the planning unit
id / number and following columns are species. If using a preloaded matrix
or data frame, unit ids should be set as row names, not in the first
column. Values indicate the suitability scores for each species / taxon in
each planning unit.</p></dd>


<dt id="arg-subregions">subregions<a class="anchor" aria-label="anchor" href="#arg-subregions"></a></dt>
<dd><p>(optional) path to a csv/tsv file or a pre-loaded data
frame or matrix defining sub-regions within the set of planning units. Must
include 1 row for each planning unit with binary values indicating the
sub-region membership of each planning unit. Sub-region column names must
match those provided in the `targets` input.</p></dd>


<dt id="arg-populations">populations<a class="anchor" aria-label="anchor" href="#arg-populations"></a></dt>
<dd><p>(optional) path to a csv/tsv file or a pre-loaded data
frame or matrix of delineated populations. When loading from file data can
be in long or wide format. Long format should consist of 3 columns,
unit_id, species, and population. Wide format should have one column per
species and one row per unit_id. If providing a data frame or matrix
directly, only wide formats is accepted and unit ids should be set as
rownames, not as a column.</p></dd>


<dt id="arg-incompatibility">incompatibility<a class="anchor" aria-label="anchor" href="#arg-incompatibility"></a></dt>
<dd><p>(optional) path to a csv/tsv file or a pre-loaded data
frame or matrix specifying species that cannot share the same planning
unit. Must be a symmetric matrix with species names as row and column
names, where a value of 1 indicates the species are incompatible (cannot be
in the same unit).</p></dd>


<dt id="arg-spatial">spatial<a class="anchor" aria-label="anchor" href="#arg-spatial"></a></dt>
<dd><p>(optional) path to a spatial file data file (.shp or .gpkg) or
a pre-loaded sf object containing the planning unit polygons. Must have the
same unit IDs as the suitability matrix included as the first column of the
attribute table.</p></dd>


<dt id="arg-min-spp-suit-score">min_spp_suit_score<a class="anchor" aria-label="anchor" href="#arg-min-spp-suit-score"></a></dt>
<dd><p>minimum suitability score for a species to be
considered in a location (default = 0.25)</p></dd>


<dt id="arg-rand-tolerance">rand_tolerance<a class="anchor" aria-label="anchor" href="#arg-rand-tolerance"></a></dt>
<dd><p>the range of species richness, from maximum, to
consider for selection at each iteration (default = 5)</p></dd>


<dt id="arg-max-spp-selected">max_spp_selected<a class="anchor" aria-label="anchor" href="#arg-max-spp-selected"></a></dt>
<dd><p>maximum number of species to select in each location
(default = -1) to reduce 'species packing' within units. This parameter
could cause species to be unable to meet targets. Use -1 for no limit.</p></dd>


<dt id="arg-single-pu-pop">single_pu_pop<a class="anchor" aria-label="anchor" href="#arg-single-pu-pop"></a></dt>
<dd><p>should only one location (ie unit) be selected per
delineated population (default = TRUE). Only applies if a known population
file (`populations`) is provided.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>number of solutions to generate (default = 100)</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>number of cores to use (default = NULL, uses all available - 1)</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>show progress bar (default = TRUE)</p></dd>


<dt id="arg-batch-size">batch_size<a class="anchor" aria-label="anchor" href="#arg-batch-size"></a></dt>
<dd><p>when parallel processing is used, this parameter can be
used to process solution in batches for improved efficiency (default =
NULL). If not provided (NULL), batch size will be calculated automatically.</p></dd>


<dt id="arg-max-batch-size">max_batch_size<a class="anchor" aria-label="anchor" href="#arg-max-batch-size"></a></dt>
<dd><p>limit batch size for parallel processing (default =
1000). Smaller values will allow the progress bar to update more
frequently, but at the cost of more disk writes.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>seed for reproducible output (optional)</p></dd>


<dt id="arg-out-dir">out_dir<a class="anchor" aria-label="anchor" href="#arg-out-dir"></a></dt>
<dd><p>location to write outputs (default = "."). If NULL, results
will be returned as a data frame and temporary files will be used.</p></dd>


<dt id="arg-run-id">run_id<a class="anchor" aria-label="anchor" href="#arg-run-id"></a></dt>
<dd><p>prefix for output files (default = "optimTFE")</p></dd>


<dt id="arg-output-csv">output_csv<a class="anchor" aria-label="anchor" href="#arg-output-csv"></a></dt>
<dd><p>Should the solutions be compiled to a single csv file
(default = TRUE)</p></dd>


<dt id="arg-return-df">return_df<a class="anchor" aria-label="anchor" href="#arg-return-df"></a></dt>
<dd><p>return all generated solutions as a data frame in the
current R session (default = FALSE)</p></dd>


<dt id="arg-force-overwrite">force_overwrite<a class="anchor" aria-label="anchor" href="#arg-force-overwrite"></a></dt>
<dd><p>overwrite existing output files (default = FALSE)</p></dd>


<dt id="arg-summary">summary<a class="anchor" aria-label="anchor" href="#arg-summary"></a></dt>
<dd><p>generate summary statistics and metrics for solutions (default
= TRUE)</p></dd>


<dt id="arg-spatial-projection">spatial_projection<a class="anchor" aria-label="anchor" href="#arg-spatial-projection"></a></dt>
<dd><p>optional projection string or epsg code to use for
spatial data. Only applicable if spatial data is provided and summary =
TRUE. A equal area projection is needed to calculate spatial metrics such
as area and perimeter.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function generates conservation footprints based on species/feature
habitat suitability scores within planning units, and a target number of
populations per species. A greedy algorithm iteratively selects planning
units with the highest number of remaining species targets until all targets
are met. To mitigate known pitfalls of richness-based selection at each
iteration, stochasticity is introduced where one planning unit is randomly
selected from a pool of planning units within a set number of targets of the
maximum for that iteration. To maximize species suitability scores in
selected units the probability of selection is weighted by the mean
suitability scores of remaining targets. Constraints, such as hybridization,
can be introduced to specifically prohibit the algorithm from selecting the
same planning unit for two taxa. This process is then repeated to generate
many spatially efficient solutions that meet all targets for each species.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Devin R Leopold, Christina R Leopold, Lucas Berio Fortini.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

